import os
from dotenv import load_dotenv
import requests
import warnings

warnings.filterwarnings(action="ignore", category=FutureWarning)

load_dotenv()


class AlphaVantage:
    def __init__(self):
        self.api_key = os.getenv('ALPHAVANTAGE_API_KEY')
        self.TOP_GAINERS_LOSERS_URL = f'https://www.alphavantage.co/query?function=TOP_GAINERS_LOSERS&apikey={self.api_key}'

    def get_top_gainers_losers(self) -> dict:
        """
        Get the 20 top gainers and losers, as well as the most actively traded stocks for the day

        Returns:
            dict: with keys ['metadata', 'last_updated', 'top_gainers', 'top_losers', 'most_actively_traded']

                'top_gainers', 'top_losers', 'most_actively_trade':
                    list of dictionaries for each ticker containing the following keys
                    ['ticker', 'price', 'change_amount', 'change_percentage', 'volume']
        """
        # request = requests.get(self.TOP_GAINERS_LOSERS_URL)
        # top_gainers_losers = request.json()
        # return top_gainers_losers

        return {'metadata': 'Top gainers, losers, and most actively traded US tickers', 'last_updated': '2024-06-27 16:16:00 US/Eastern', 'top_gainers': [{'ticker': 'GOVXW', 'price': '0.17', 'change_amount': '0.1021', 'change_percentage': '150.3682%', 'volume': '209259'}, {'ticker': 'ESGLW', 'price': '0.0137', 'change_amount': '0.0076', 'change_percentage': '124.5902%', 'volume': '5450'}, {'ticker': 'JTAIW', 'price': '0.07', 'change_amount': '0.035', 'change_percentage': '100.0%', 'volume': '886240'}, {'ticker': 'AOGOW', 'price': '0.06', 'change_amount': '0.0299', 'change_percentage': '99.3355%', 'volume': '43478'}, {'ticker': 'NUKKW', 'price': '0.0447', 'change_amount': '0.0207', 'change_percentage': '86.25%', 'volume': '84481'}, {'ticker': 'BNZIW', 'price': '0.0288', 'change_amount': '0.0133', 'change_percentage': '85.8065%', 'volume': '50'}, {'ticker': 'IONM', 'price': '0.424', 'change_amount': '0.192', 'change_percentage': '82.7586%', 'volume': '189130687'}, {'ticker': 'GOVX', 'price': '3.55', 'change_amount': '1.535', 'change_percentage': '76.1787%', 'volume': '79982587'}, {'ticker': 'ALSAW', 'price': '0.0128', 'change_amount': '0.0051', 'change_percentage': '66.2338%', 'volume': '3731'}, {'ticker': 'IVP', 'price': '2.23', 'change_amount': '0.88', 'change_percentage': '65.1852%', 'volume': '2496744'}, {'ticker': 'DRMAW', 'price': '0.013', 'change_amount': '0.005', 'change_percentage': '62.5%', 'volume': '6100'}, {'ticker': 'IVCBW', 'price': '0.0812', 'change_amount': '0.0312', 'change_percentage': '62.4%', 'volume': '741'}, {'ticker': 'EDBLW', 'price': '0.021', 'change_amount': '0.0079', 'change_percentage': '60.3053%', 'volume': '8815'}, {'ticker': 'XBP', 'price': '1.93', 'change_amount': '0.71', 'change_percentage': '58.1967%', 'volume': '10132888'}, {'ticker': 'MACAW', 'price': '0.11', 'change_amount': '0.0355', 'change_percentage': '47.651%', 'volume': '350'}, {'ticker': 'SDAWW', 'price': '0.221', 'change_amount': '0.071', 'change_percentage': '47.3333%', 'volume': '35284'}, {'ticker': 'LFLYW', 'price': '0.0229', 'change_amount': '0.0072', 'change_percentage': '45.8599%', 'volume': '3307'}, {'ticker': 'DECA', 'price': '11.29', 'change_amount': '3.52', 'change_percentage': '45.3024%', 'volume': '204646'}, {'ticker': 'FGIWW', 'price': '0.1888', 'change_amount': '0.0574', 'change_percentage': '43.6834%', 'volume': '650'}, {'ticker': 'KALA', 'price': '6.45', 'change_amount': '1.93', 'change_percentage': '42.6991%', 'volume': '11571491'}], 'top_losers': [{'ticker': 'DECAW', 'price': '0.02', 'change_amount': '-0.055', 'change_percentage': '-73.3333%', 'volume': '334884'}, {'ticker': 'YOTAW', 'price': '0.0106', 'change_amount': '-0.0155', 'change_percentage': '-59.387%', 'volume': '2000'}, {'ticker': 'GRDIW', 'price': '0.0635', 'change_amount': '-0.0864', 'change_percentage': '-57.6384%', 'volume': '155030'}, {'ticker': 'BJDX', 'price': '0.75', 'change_amount': '-0.88', 'change_percentage': '-53.9877%', 'volume': '5447538'}, {'ticker': 'BIAFW', 'price': '0.3005', 'change_amount': '-0.3293', 'change_percentage': '-52.2864%', 'volume': '1000'}, {'ticker': 'IMAQW', 'price': '0.007', 'change_amount': '-0.007', 'change_percentage': '-50.0%', 'volume': '10100'}, {'ticker': 'BOF', 'price': '0.68', 'change_amount': '-0.63', 'change_percentage': '-48.0916%', 'volume': '1427970'}, {'ticker': 'GRDI', 'price': '1.22', 'change_amount': '-1.12', 'change_percentage': '-47.8632%', 'volume': '9511545'}, {'ticker': 'ALUR+', 'price': '0.1662', 'change_amount': '-0.1313', 'change_percentage': '-44.1345%', 'volume': '709'}, {'ticker': 'SVMHW', 'price': '0.0105', 'change_amount': '-0.008', 'change_percentage': '-43.2432%', 'volume': '9894'}, {'ticker': 'NMHIW', 'price': '0.023', 'change_amount': '-0.017', 'change_percentage': '-42.5%', 'volume': '2'}, {'ticker': 'TNXP', 'price': '0.69', 'change_amount': '-0.435', 'change_percentage': '-38.6667%', 'volume': '8413708'}, {'ticker': 'MSAIW', 'price': '0.025', 'change_amount': '-0.0145', 'change_percentage': '-36.7089%', 'volume': '21709'}, {'ticker': 'APLMW', 'price': '0.01', 'change_amount': '-0.0056', 'change_percentage': '-35.8974%', 'volume': '5550'}, {'ticker': 'LSBPW', 'price': '0.0512', 'change_amount': '-0.0286', 'change_percentage': '-35.8396%', 'volume': '4143'}, {'ticker': 'BFIIW', 'price': '0.0163', 'change_amount': '-0.0091', 'change_percentage': '-35.8268%', 'volume': '2882'}, {'ticker': 'FTIIW', 'price': '0.0161', 'change_amount': '-0.0089', 'change_percentage': '-35.6%', 'volume': '6778'}, {'ticker': 'PIIIW', 'price': '0.0502', 'change_amount': '-0.0267', 'change_percentage': '-34.7204%', 'volume': '1'}, {'ticker': 'ZEO', 'price': '2.13', 'change_amount': '-1.08', 'change_percentage': '-33.6449%', 'volume': '12248'}, {'ticker': 'XFOR', 'price': '0.6701', 'change_amount': '-0.3299', 'change_percentage': '-32.99%', 'volume': '16089653'}], 'most_actively_traded': [{'ticker': 'FFIE', 'price': '0.6', 'change_amount': '0.1415', 'change_percentage': '30.8615%', 'volume': '559714071'}, {'ticker': 'NVDA', 'price': '123.99', 'change_amount': '-2.41', 'change_percentage': '-1.9066%', 'volume': '248839268'}, {'ticker': 'IONM', 'price': '0.424', 'change_amount': '0.192', 'change_percentage': '82.7586%', 'volume': '189130687'}, {'ticker': 'NLSP', 'price': '0.24', 'change_amount': '0.0574', 'change_percentage': '31.4348%', 'volume': '161353203'}, {'ticker': 'WBA', 'price': '12.19', 'change_amount': '-3.47', 'change_percentage': '-22.1584%', 'volume': '131876300'}, {'ticker': 'DNA', 'price': '0.307', 'change_amount': '0.0231', 'change_percentage': '8.1367%', 'volume': '125551149'}, {'ticker': 'SQQQ', 'price': '8.13', 'change_amount': '-0.05', 'change_percentage': '-0.6112%', 'volume': '111131461'}, {'ticker': 'SING', 'price': '0.1805', 'change_amount': '0.0315', 'change_percentage': '21.1409%', 'volume': '108653864'}, {'ticker': 'RIVN', 'price': '14.47', 'change_amount': '-0.27', 'change_percentage': '-1.8318%', 'volume': '96025456'}, {'ticker': 'GOVX', 'price': '3.55', 'change_amount': '1.535', 'change_percentage': '76.1787%', 'volume': '79982587'}, {'ticker': 'AMZN', 'price': '197.85', 'change_amount': '4.24', 'change_percentage': '2.19%', 'volume': '73565869'}, {'ticker': 'TSLA', 'price': '197.42', 'change_amount': '1.05', 'change_percentage': '0.5347%', 'volume': '71953221'}, {'ticker': 'MU', 'price': '132.23', 'change_amount': '-10.13', 'change_percentage': '-7.1158%', 'volume': '66321348'}, {'ticker': 'SOBR', 'price': '0.152', 'change_amount': '0.013', 'change_percentage': '9.3525%', 'volume': '65277452'}, {'ticker': 'CHWY', 'price': '29.13', 'change_amount': '-0.01', 'change_percentage': '-0.0343%', 'volume': '63434120'}, {'ticker': 'VHAI', 'price': '0.0765', 'change_amount': '0.0054', 'change_percentage': '7.5949%', 'volume': '51392768'}, {'ticker': 'AAPL', 'price': '214.1', 'change_amount': '0.85', 'change_percentage': '0.3986%', 'volume': '49572160'}, {'ticker': 'F', 'price': '12.23', 'change_amount': '0.12', 'change_percentage': '0.9909%', 'volume': '48014708'}, {'ticker': 'ONCO', 'price': '0.2049', 'change_amount': '0.0499', 'change_percentage': '32.1935%', 'volume': '45090749'}, {'ticker': 'BSFC', 'price': '2.29', 'change_amount': '0.51', 'change_percentage': '28.6517%', 'volume': '43226893'}]}
