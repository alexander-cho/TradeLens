{% extends 'base.html' %}

{% block content %}

    <h1>{{ stock.ticker_symbol }}</h1>
    <h4>{{ stock.company_name }}</h4>

    {% for column in ohlcv_data.columns %}
        {% if column not in ['Volume', 'Dividends', 'Stock Splits', 'Capital Gains'] %}
            {{ column }}: ${{ '%.2f'|format(ohlcv_data[column][0]) }} <br>
        {% elif column == 'Volume' %}
            {{ column }}: {{ '{:,.0f}'.format(ohlcv_data[column][0]) }} shares traded
        {% endif %}
    {% endfor %}
    <br>
    {% if shares_outstanding %}
        Shares outstanding: {{ '{:,.0f}'.format( shares_outstanding) }}
    {% endif %}

    <h3>Institutional Holdings</h3>
    {% if institutional_holders %}
        {{ institutional_holders }}
    {% else %}
        <p>Institutional holder information is not available for {{ stock.ticker_symbol }}</p>
    {% endif %}

    <h3>Insider Activity</h3>
    {% if insider_transactions %}
        {{ insider_transactions }}
    {% else %}
        <p>Insider activity information is not available for {{ stock.ticker_symbol }}</p>
    {% endif %}

    <p>
    Market Capitalization: {{ '${:,.0f}'.format(fast_info['marketCap']) }} <br>
    </p>

    <h3>Calendar</h3>
    <p>
    {% for k, v in calendar.items() %}  <!-- earnings_forecast is of type dictionary -->
        {% if k in ['Dividend Date', 'Ex-Dividend Date'] %}  <!-- Dividend calendar -->
            {{ k }}: {{ v }} <br>
        {% elif k == 'Earnings Date' %}
            {% if v|length == 1 %}  <!-- if next earnings date is confirmed -->
                {{ k }}: {{ v[0] }} <br>
            {% else %}
                {{ k }}: Between {{ v[0] }} and {{ v[1] }} <br>
            {% endif %}
        {% elif k in ['Earnings High', 'Earnings Low', 'Earnings Average'] %}  <!-- EPS -->
            {{ k }}: ${{ '{:.2f}'.format(v) }} per share <br>
        {% else %}  <!-- Revenue estimates -->
            {{ k }}: {{ '${:,.0f}'.format(v) }} <br>
        {% endif %}
    {% endfor %}
    </p>

    {#% include 'add_post.html' %#}

    <br>
    {% for post in symbol_posts %}
        {% include '_post.html' %}
    {% endfor %}

{% endblock %}